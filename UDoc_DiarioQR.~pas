unit UDoc_DiarioQR;

interface

uses Windows, SysUtils, Messages, Classes, Graphics, Controls,
  StdCtrls, ExtCtrls, Forms, Quickrpt, QRCtrls, QrAngLbl, ECC_Extenso, jpeg;

type
  TDoc_DiarioQR = class(TQuickRep)
    TitleBand1: TQRBand;
    QRLabel4: TQRLabel;
    QRLabel1: TQRLabel;
    QRLabel5: TQRLabel;
    QRImage1: TQRImage;
    QRLabel12: TQRLabel;
    QRShape10: TQRShape;
    QRShape11: TQRShape;
    L01: TQRShape;
    QRLabel7: TQRLabel;
    Tit1: TQRLabel;
    Tit2: TQRLabel;
    DetNota: TQRBand;
    QRDBText2: TQRDBText;
    QRDBText3: TQRDBText;
    QRDBText4: TQRDBText;
    QRShape6: TQRShape;
    QRShape7: TQRShape;
    QRShape8: TQRShape;
    QRShape40: TQRShape;
    QRShape41: TQRShape;
    Tot_Faltas: TQRDBText;
    QRShape5: TQRShape;
    QRLabel2: TQRLabel;
    QRDBText5: TQRDBText;
    QRShape3: TQRShape;
    QRLabel6: TQRLabel;
    QRLabel8: TQRLabel;
    QRShape42: TQRShape;
    QRShape4: TQRShape;
    QRShape12: TQRShape;
    Lin01: TQRShape;
    Lin02: TQRShape;
    Lin03: TQRShape;
    Lin04: TQRShape;
    Lin06: TQRShape;
    Lin05: TQRShape;
    Lin07: TQRShape;
    Lin08: TQRShape;
    Lin09: TQRShape;
    Lin10: TQRShape;
    Tit3: TQRLabel;
    Tit4: TQRLabel;
    F01: TQRLabel;
    F02: TQRLabel;
    F03: TQRLabel;
    F04: TQRLabel;
    F05: TQRLabel;
    F06: TQRLabel;
    F07: TQRLabel;
    F08: TQRLabel;
    F09: TQRLabel;
    F10: TQRLabel;
    F11: TQRLabel;
    QRShape2: TQRShape;
    QRShape15: TQRShape;
    QRShape16: TQRShape;
    Lin11: TQRShape;
    Lin12: TQRShape;
    Lin13: TQRShape;
    Lin14: TQRShape;
    Lin15: TQRShape;
    Lin16: TQRShape;
    Lin17: TQRShape;
    Lin18: TQRShape;
    Lin19: TQRShape;
    Lin20: TQRShape;
    Lin21: TQRShape;
    Lin22: TQRShape;
    Lin23: TQRShape;
    Lin24: TQRShape;
    Lin25: TQRShape;
    Lin26: TQRShape;
    Lin27: TQRShape;
    Lin28: TQRShape;
    Lin29: TQRShape;
    Lin30: TQRShape;
    Lin31: TQRShape;
    Lin32: TQRShape;
    Lin33: TQRShape;
    Lin34: TQRShape;
    Lin35: TQRShape;
    Lin36: TQRShape;
    Lin37: TQRShape;
    Lin38: TQRShape;
    Lin39: TQRShape;
    Lin40: TQRShape;
    Lin41: TQRShape;
    Lin42: TQRShape;
    Lin43: TQRShape;
    Lin44: TQRShape;
    Lin45: TQRShape;
    Lin46: TQRShape;
    Lin47: TQRShape;
    Lin48: TQRShape;
    Lin49: TQRShape;
    Lin50: TQRShape;
    Lin51: TQRShape;
    Lin52: TQRShape;
    Lin53: TQRShape;
    Lin54: TQRShape;
    Lin55: TQRShape;
    Lin56: TQRShape;
    Lin57: TQRShape;
    Lin58: TQRShape;
    Lin59: TQRShape;
    Lin60: TQRShape;
    Lin61: TQRShape;
    F12: TQRLabel;
    F13: TQRLabel;
    F14: TQRLabel;
    F15: TQRLabel;
    F16: TQRLabel;
    F17: TQRLabel;
    F18: TQRLabel;
    F19: TQRLabel;
    F20: TQRLabel;
    F21: TQRLabel;
    F22: TQRLabel;
    F23: TQRLabel;
    F24: TQRLabel;
    F25: TQRLabel;
    F26: TQRLabel;
    F27: TQRLabel;
    F28: TQRLabel;
    F29: TQRLabel;
    F30: TQRLabel;
    F31: TQRLabel;
    F32: TQRLabel;
    F33: TQRLabel;
    F34: TQRLabel;
    F35: TQRLabel;
    F36: TQRLabel;
    F37: TQRLabel;
    F38: TQRLabel;
    F39: TQRLabel;
    F40: TQRLabel;
    F41: TQRLabel;
    F42: TQRLabel;
    F43: TQRLabel;
    F44: TQRLabel;
    F45: TQRLabel;
    F46: TQRLabel;
    F47: TQRLabel;
    F48: TQRLabel;
    F49: TQRLabel;
    F50: TQRLabel;
    F51: TQRLabel;
    F52: TQRLabel;
    F53: TQRLabel;
    F54: TQRLabel;
    F55: TQRLabel;
    F56: TQRLabel;
    F57: TQRLabel;
    F58: TQRLabel;
    F59: TQRLabel;
    F60: TQRLabel;
    QRLabel9: TQRLabel;
    QRSysData1: TQRSysData;
    L02: TQRShape;
    L03: TQRShape;
    L04: TQRShape;
    L05: TQRShape;
    L06: TQRShape;
    L07: TQRShape;
    L08: TQRShape;
    L09: TQRShape;
    L10: TQRShape;
    L11: TQRShape;
    L12: TQRShape;
    L13: TQRShape;
    L14: TQRShape;
    L15: TQRShape;
    L16: TQRShape;
    L17: TQRShape;
    L18: TQRShape;
    L19: TQRShape;
    L20: TQRShape;
    L21: TQRShape;
    L22: TQRShape;
    L23: TQRShape;
    L24: TQRShape;
    L25: TQRShape;
    L26: TQRShape;
    L27: TQRShape;
    L28: TQRShape;
    L29: TQRShape;
    L30: TQRShape;
    L31: TQRShape;
    L32: TQRShape;
    L33: TQRShape;
    L34: TQRShape;
    L35: TQRShape;
    L36: TQRShape;
    L37: TQRShape;
    L38: TQRShape;
    L39: TQRShape;
    L40: TQRShape;
    L41: TQRShape;
    L42: TQRShape;
    L43: TQRShape;
    L44: TQRShape;
    L45: TQRShape;
    L46: TQRShape;
    L47: TQRShape;
    L48: TQRShape;
    L49: TQRShape;
    L50: TQRShape;
    L51: TQRShape;
    L52: TQRShape;
    L53: TQRShape;
    L54: TQRShape;
    L55: TQRShape;
    L56: TQRShape;
    L57: TQRShape;
    L58: TQRShape;
    L59: TQRShape;
    L60: TQRShape;
    L61: TQRShape;
    QRShape1: TQRShape;
    A01: TQRLabel;
    A02: TQRLabel;
    A03: TQRLabel;
    A04: TQRLabel;
    A05: TQRLabel;
    A06: TQRLabel;
    A07: TQRLabel;
    A08: TQRLabel;
    A09: TQRLabel;
    A10: TQRLabel;
    B01: TQRLabel;
    B02: TQRLabel;
    B03: TQRLabel;
    B04: TQRLabel;
    B05: TQRLabel;
    B06: TQRLabel;
    B07: TQRLabel;
    B08: TQRLabel;
    B09: TQRLabel;
    B10: TQRLabel;
    A11: TQRLabel;
    A12: TQRLabel;
    A13: TQRLabel;
    A14: TQRLabel;
    A15: TQRLabel;
    A16: TQRLabel;
    A17: TQRLabel;
    A18: TQRLabel;
    A19: TQRLabel;
    A20: TQRLabel;
    A21: TQRLabel;
    A22: TQRLabel;
    A23: TQRLabel;
    A24: TQRLabel;
    A25: TQRLabel;
    A26: TQRLabel;
    A27: TQRLabel;
    A28: TQRLabel;
    A29: TQRLabel;
    A30: TQRLabel;
    A31: TQRLabel;
    A32: TQRLabel;
    A33: TQRLabel;
    A34: TQRLabel;
    A35: TQRLabel;
    A36: TQRLabel;
    A37: TQRLabel;
    A38: TQRLabel;
    A39: TQRLabel;
    A40: TQRLabel;
    A42: TQRLabel;
    A43: TQRLabel;
    A44: TQRLabel;
    A45: TQRLabel;
    A46: TQRLabel;
    A47: TQRLabel;
    A48: TQRLabel;
    A49: TQRLabel;
    A50: TQRLabel;
    A51: TQRLabel;
    A52: TQRLabel;
    A53: TQRLabel;
    A54: TQRLabel;
    A55: TQRLabel;
    A56: TQRLabel;
    A57: TQRLabel;
    A58: TQRLabel;
    A59: TQRLabel;
    A60: TQRLabel;
    B11: TQRLabel;
    B12: TQRLabel;
    B13: TQRLabel;
    B14: TQRLabel;
    B15: TQRLabel;
    B16: TQRLabel;
    B17: TQRLabel;
    B18: TQRLabel;
    B19: TQRLabel;
    B20: TQRLabel;
    B21: TQRLabel;
    B22: TQRLabel;
    B23: TQRLabel;
    B24: TQRLabel;
    B25: TQRLabel;
    B26: TQRLabel;
    B27: TQRLabel;
    B28: TQRLabel;
    B29: TQRLabel;
    B30: TQRLabel;
    B31: TQRLabel;
    B32: TQRLabel;
    B33: TQRLabel;
    B34: TQRLabel;
    B35: TQRLabel;
    B36: TQRLabel;
    B37: TQRLabel;
    B38: TQRLabel;
    B39: TQRLabel;
    B40: TQRLabel;
    B41: TQRLabel;
    B42: TQRLabel;
    B43: TQRLabel;
    B44: TQRLabel;
    B45: TQRLabel;
    B46: TQRLabel;
    B47: TQRLabel;
    B48: TQRLabel;
    B49: TQRLabel;
    B50: TQRLabel;
    B51: TQRLabel;
    B52: TQRLabel;
    B53: TQRLabel;
    B54: TQRLabel;
    B55: TQRLabel;
    B56: TQRLabel;
    B57: TQRLabel;
    B58: TQRLabel;
    B59: TQRLabel;
    B60: TQRLabel;
    A41: TQRLabel;
    QRBand1: TQRBand;
    SummaryBand1: TQRBand;
    QRLabel10: TQRLabel;
    DataExt: TQRECC_DataExtenso;
    QRLabel11: TQRLabel;
    AulasPr: TQRLabel;
    AulasDd: TQRLabel;
    AulasPrevistas: TQRLabel;
    AulasDadas: TQRLabel;
    QRLabel15: TQRLabel;
    Media: TQRLabel;
    QRObs: TQRMemo;
    procedure TitleBand1BeforePrint(Sender: TQRCustomBand;
      var PrintBand: Boolean);
    procedure DetNotaBeforePrint(Sender: TQRCustomBand;
      var PrintBand: Boolean);
    procedure Tot_FaltasPrint(sender: TObject; var Value: String);
    procedure SummaryBand1BeforePrint(Sender: TQRCustomBand;
      var PrintBand: Boolean);
  private
    function Dia_Dezena() : String;
    function Dia_Unidade() : String;
    function Det_Falta_X(coluna : integer) : String;
  public

  end;

var
  Doc_DiarioQR: TDoc_DiarioQR;
  i1,i2,j,aulasD, cont : integer;
  m_det_faltas    : string;

implementation

uses UDM, UDoc_Diario, UMenu;

{$R *.DFM}


function TDoc_DiarioQR.Dia_Dezena() : String;
begin
  if not DM.DiarioD.Eof then begin
    inc(aulasD);
    result := Copy(FormatDateTime('dd',DM.DiarioDDATA.Value),1,1); end
   else
    result := '';
//  if (Doc_Diario.Bimestre.ItemIndex = 4) then result := ''; //Este linha tira os dias do diários quando seleciona exame
end;


function TDoc_DiarioQR.Dia_Unidade() : String;
begin
  if not DM.DiarioD.Eof then
  Begin
    result := Copy(FormatDateTime('dd',DM.DiarioDDATA.Value),2,1) end
   else
    result := '';
//  if (Doc_Diario.Bimestre.ItemIndex = 4) then result := ''; //Este linha tira os dias do diários quando seleciona exame
  DM.DiarioD.Next;
end;

function TDoc_DiarioQR.Det_Falta_X(coluna : integer) : String;
begin
  result := Copy(m_det_faltas,coluna,1);
  if Doc_Diario.Bimestre.ItemIndex = 4 then result := '-';
end;

procedure TDoc_DiarioQR.TitleBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
var periodo_x : string;

begin
  aulasD := 0;
  DM.DiarioD.First;
  case DM.TurmasPERIODO.Value of
    1 : periodo_x := 'Matutino';
    2 : periodo_x := 'Vespertino';
    3 : periodo_x := 'Noturno';
  end;
  if DM.BimestresCODIGO.Value < 5 then
    Tit2.Caption := StringReplace(Tit2.Caption, '{BIMESTRE}', DM.BimestresCODIGO.AsString+'º BIMESTRE', [rfReplaceAll])
   else
  Tit2.Caption := StringReplace(Tit2.Caption, '{BIMESTRE}', 'EXAME FINAL', [rfReplaceAll]);
  Tit2.Caption := StringReplace(Tit2.Caption, '{ANO}', Principal.Ano.Caption, [rfReplaceAll]);
  Tit2.Caption := StringReplace(Tit2.Caption, '{DATA_INICIAL}', DM.BimestresINICIO.AsString, [rfReplaceAll]);
  Tit2.Caption := StringReplace(Tit2.Caption, '{DATA_FINAL}', DM.BimestresFIM.AsString, [rfReplaceAll]);
  Tit2.Caption := StringReplace(Tit2.Caption, '{SERIE}', DM.TurmasSERIE.AsString, [rfReplaceAll]);
  Tit2.Caption := StringReplace(Tit2.Caption, '{TURMA}', DM.TurmasTURMA.AsString, [rfReplaceAll]);
  Tit2.Caption := StringReplace(Tit2.Caption, '{PERIODO}', periodo_x, [rfReplaceAll]);
  Tit2.Caption := StringReplace(Tit2.Caption, '{DISCIPLINA}', DM.DisciplinasNOME.Value, [rfReplaceAll]);
  Tit3.Caption := StringReplace(Tit3.Caption, '{SERIE}', DM.TurmasSERIE.AsString, [rfReplaceAll]);
  Tit3.Caption := StringReplace(Tit3.Caption, '{TURMA}', DM.TurmasTURMA.AsString, [rfReplaceAll]);
  if DM.BimestresCODIGO.Value < 5 then
    Tit4.Caption := StringReplace(Tit4.Caption, '{BIMESTRE}', DM.BimestresCODIGO.AsString+'º BIMESTRE', [rfReplaceAll])
   else
    Tit4.Caption := StringReplace(Tit4.Caption, '{BIMESTRE}', 'EXAME FINAL', [rfReplaceAll]);
  Tit4.Caption := StringReplace(Tit4.Caption, '{ANO}', Principal.Ano.Caption, [rfReplaceAll]);
  DetNota.Color := DM.ParametrosCOR_ZEBRADO.Value;
  i1 := 344;
  i2 := 349;
  j := 12;
  Lin01.Left := i1+(j*01);  L01.Left := i1+(j*01);  F01.Left := i2+(j*01);  A01.Left := i2+(j*01);  B01.Left := i2+(j*01);
  Lin02.Left := i1+(j*02);  L02.Left := i1+(j*02);  F02.Left := i2+(j*02);  A02.Left := i2+(j*02);  B02.Left := i2+(j*02);
  Lin03.Left := i1+(j*03);  L03.Left := i1+(j*03);  F03.Left := i2+(j*03);  A03.Left := i2+(j*03);  B03.Left := i2+(j*03);
  Lin04.Left := i1+(j*04);  L04.Left := i1+(j*04);  F04.Left := i2+(j*04);  A04.Left := i2+(j*04);  B04.Left := i2+(j*04);
  Lin05.Left := i1+(j*05);  L05.Left := i1+(j*05);  F05.Left := i2+(j*05);  A05.Left := i2+(j*05);  B05.Left := i2+(j*05);
  Lin06.Left := i1+(j*06);  L06.Left := i1+(j*06);  F06.Left := i2+(j*06);  A06.Left := i2+(j*06);  B06.Left := i2+(j*06);
  Lin07.Left := i1+(j*07);  L07.Left := i1+(j*07);  F07.Left := i2+(j*07);  A07.Left := i2+(j*07);  B07.Left := i2+(j*07);
  Lin08.Left := i1+(j*08);  L08.Left := i1+(j*08);  F08.Left := i2+(j*08);  A08.Left := i2+(j*08);  B08.Left := i2+(j*08);
  Lin09.Left := i1+(j*09);  L09.Left := i1+(j*09);  F09.Left := i2+(j*09);  A09.Left := i2+(j*09);  B09.Left := i2+(j*09);
  Lin10.Left := i1+(j*10);  L10.Left := i1+(j*10);  F10.Left := i2+(j*10);  A10.Left := i2+(j*10);  B10.Left := i2+(j*10);
  Lin11.Left := i1+(j*11);  L11.Left := i1+(j*11);  F11.Left := i2+(j*11);  A11.Left := i2+(j*11);  B11.Left := i2+(j*11);
  Lin12.Left := i1+(j*12);  L12.Left := i1+(j*12);  F12.Left := i2+(j*12);  A12.Left := i2+(j*12);  B12.Left := i2+(j*12);
  Lin13.Left := i1+(j*13);  L13.Left := i1+(j*13);  F13.Left := i2+(j*13);  A13.Left := i2+(j*13);  B13.Left := i2+(j*13);
  Lin14.Left := i1+(j*14);  L14.Left := i1+(j*14);  F14.Left := i2+(j*14);  A14.Left := i2+(j*14);  B14.Left := i2+(j*14);
  Lin15.Left := i1+(j*15);  L15.Left := i1+(j*15);  F15.Left := i2+(j*15);  A15.Left := i2+(j*15);  B15.Left := i2+(j*15);
  Lin16.Left := i1+(j*16);  L16.Left := i1+(j*16);  F16.Left := i2+(j*16);  A16.Left := i2+(j*16);  B16.Left := i2+(j*16);
  Lin17.Left := i1+(j*17);  L17.Left := i1+(j*17);  F17.Left := i2+(j*17);  A17.Left := i2+(j*17);  B17.Left := i2+(j*17);
  Lin18.Left := i1+(j*18);  L18.Left := i1+(j*18);  F18.Left := i2+(j*18);  A18.Left := i2+(j*18);  B18.Left := i2+(j*18);
  Lin19.Left := i1+(j*19);  L19.Left := i1+(j*19);  F19.Left := i2+(j*19);  A19.Left := i2+(j*19);  B19.Left := i2+(j*19);
  Lin20.Left := i1+(j*20);  L20.Left := i1+(j*20);  F20.Left := i2+(j*20);  A20.Left := i2+(j*20);  B20.Left := i2+(j*20);
  Lin21.Left := i1+(j*21);  L21.Left := i1+(j*21);  F21.Left := i2+(j*21);  A21.Left := i2+(j*21);  B21.Left := i2+(j*21);
  Lin22.Left := i1+(j*22);  L22.Left := i1+(j*22);  F22.Left := i2+(j*22);  A22.Left := i2+(j*22);  B22.Left := i2+(j*22);
  Lin23.Left := i1+(j*23);  L23.Left := i1+(j*23);  F23.Left := i2+(j*23);  A23.Left := i2+(j*23);  B23.Left := i2+(j*23);
  Lin24.Left := i1+(j*24);  L24.Left := i1+(j*24);  F24.Left := i2+(j*24);  A24.Left := i2+(j*24);  B24.Left := i2+(j*24);
  Lin25.Left := i1+(j*25);  L25.Left := i1+(j*25);  F25.Left := i2+(j*25);  A25.Left := i2+(j*25);  B25.Left := i2+(j*25);
  Lin26.Left := i1+(j*26);  L26.Left := i1+(j*26);  F26.Left := i2+(j*26);  A26.Left := i2+(j*26);  B26.Left := i2+(j*26);
  Lin27.Left := i1+(j*27);  L27.Left := i1+(j*27);  F27.Left := i2+(j*27);  A27.Left := i2+(j*27);  B27.Left := i2+(j*27);
  Lin28.Left := i1+(j*28);  L28.Left := i1+(j*28);  F28.Left := i2+(j*28);  A28.Left := i2+(j*28);  B28.Left := i2+(j*28);
  Lin29.Left := i1+(j*29);  L29.Left := i1+(j*29);  F29.Left := i2+(j*29);  A29.Left := i2+(j*29);  B29.Left := i2+(j*29);
  Lin30.Left := i1+(j*30);  L30.Left := i1+(j*30);  F30.Left := i2+(j*30);  A30.Left := i2+(j*30);  B30.Left := i2+(j*30);
  Lin31.Left := i1+(j*31);  L31.Left := i1+(j*31);  F31.Left := i2+(j*31);  A31.Left := i2+(j*31);  B31.Left := i2+(j*31);
  Lin32.Left := i1+(j*32);  L32.Left := i1+(j*32);  F32.Left := i2+(j*32);  A32.Left := i2+(j*32);  B32.Left := i2+(j*32);
  Lin33.Left := i1+(j*33);  L33.Left := i1+(j*33);  F33.Left := i2+(j*33);  A33.Left := i2+(j*33);  B33.Left := i2+(j*33);
  Lin34.Left := i1+(j*34);  L34.Left := i1+(j*34);  F34.Left := i2+(j*34);  A34.Left := i2+(j*34);  B34.Left := i2+(j*34);
  Lin35.Left := i1+(j*35);  L35.Left := i1+(j*35);  F35.Left := i2+(j*35);  A35.Left := i2+(j*35);  B35.Left := i2+(j*35);
  Lin36.Left := i1+(j*36);  L36.Left := i1+(j*36);  F36.Left := i2+(j*36);  A36.Left := i2+(j*36);  B36.Left := i2+(j*36);
  Lin37.Left := i1+(j*37);  L37.Left := i1+(j*37);  F37.Left := i2+(j*37);  A37.Left := i2+(j*37);  B37.Left := i2+(j*37);
  Lin38.Left := i1+(j*38);  L38.Left := i1+(j*38);  F38.Left := i2+(j*38);  A38.Left := i2+(j*38);  B38.Left := i2+(j*38);
  Lin39.Left := i1+(j*39);  L39.Left := i1+(j*39);  F39.Left := i2+(j*39);  A39.Left := i2+(j*39);  B39.Left := i2+(j*39);
  Lin40.Left := i1+(j*40);  L40.Left := i1+(j*40);  F40.Left := i2+(j*40);  A40.Left := i2+(j*40);  B40.Left := i2+(j*40);
  Lin41.Left := i1+(j*41);  L41.Left := i1+(j*41);  F41.Left := i2+(j*41);  A41.Left := i2+(j*41);  B41.Left := i2+(j*41);
  Lin42.Left := i1+(j*42);  L42.Left := i1+(j*42);  F42.Left := i2+(j*42);  A42.Left := i2+(j*42);  B42.Left := i2+(j*42);
  Lin43.Left := i1+(j*43);  L43.Left := i1+(j*43);  F43.Left := i2+(j*43);  A43.Left := i2+(j*43);  B43.Left := i2+(j*43);
  Lin44.Left := i1+(j*44);  L44.Left := i1+(j*44);  F44.Left := i2+(j*44);  A44.Left := i2+(j*44);  B44.Left := i2+(j*44);
  Lin45.Left := i1+(j*45);  L45.Left := i1+(j*45);  F45.Left := i2+(j*45);  A45.Left := i2+(j*45);  B45.Left := i2+(j*45);
  Lin46.Left := i1+(j*46);  L46.Left := i1+(j*46);  F46.Left := i2+(j*46);  A46.Left := i2+(j*46);  B46.Left := i2+(j*46);
  Lin47.Left := i1+(j*47);  L47.Left := i1+(j*47);  F47.Left := i2+(j*47);  A47.Left := i2+(j*47);  B47.Left := i2+(j*47);
  Lin48.Left := i1+(j*48);  L48.Left := i1+(j*48);  F48.Left := i2+(j*48);  A48.Left := i2+(j*48);  B48.Left := i2+(j*48);
  Lin49.Left := i1+(j*49);  L49.Left := i1+(j*49);  F49.Left := i2+(j*49);  A49.Left := i2+(j*49);  B49.Left := i2+(j*49);
  Lin50.Left := i1+(j*50);  L50.Left := i1+(j*50);  F50.Left := i2+(j*50);  A50.Left := i2+(j*50);  B50.Left := i2+(j*50);
  Lin51.Left := i1+(j*51);  L51.Left := i1+(j*51);  F51.Left := i2+(j*51);  A51.Left := i2+(j*51);  B51.Left := i2+(j*51);
  Lin52.Left := i1+(j*52);  L52.Left := i1+(j*52);  F52.Left := i2+(j*52);  A52.Left := i2+(j*52);  B52.Left := i2+(j*52);
  Lin53.Left := i1+(j*53);  L53.Left := i1+(j*53);  F53.Left := i2+(j*53);  A53.Left := i2+(j*53);  B53.Left := i2+(j*53);
  Lin54.Left := i1+(j*54);  L54.Left := i1+(j*54);  F54.Left := i2+(j*54);  A54.Left := i2+(j*54);  B54.Left := i2+(j*54);
  Lin55.Left := i1+(j*55);  L55.Left := i1+(j*55);  F55.Left := i2+(j*55);  A55.Left := i2+(j*55);  B55.Left := i2+(j*55);
  Lin56.Left := i1+(j*56);  L56.Left := i1+(j*56);  F56.Left := i2+(j*56);  A56.Left := i2+(j*56);  B56.Left := i2+(j*56);
  Lin57.Left := i1+(j*57);  L57.Left := i1+(j*57);  F57.Left := i2+(j*57);  A57.Left := i2+(j*57);  B57.Left := i2+(j*57);
  Lin58.Left := i1+(j*58);  L58.Left := i1+(j*58);  F58.Left := i2+(j*58);  A58.Left := i2+(j*58);  B58.Left := i2+(j*58);
  Lin59.Left := i1+(j*59);  L59.Left := i1+(j*59);  F59.Left := i2+(j*59);  A59.Left := i2+(j*59);  B59.Left := i2+(j*59);
  Lin60.Left := i1+(j*60);  L60.Left := i1+(j*60);  F60.Left := i2+(j*60);  A60.Left := i2+(j*60);  B60.Left := i2+(j*60);
  Lin61.Left := i1+(j*61);  L61.Left := i1+(j*61);
if (Doc_Diario.Bimestre.ItemIndex = 4) then
     Begin
      A01.Caption := Dia_Dezena();   B01.Caption := Dia_Unidade();
      A02.Caption := ' ';   B02.Caption := ' ';
      A03.Caption := ' ';   B03.Caption := ' ';
      A04.Caption := ' ';   B04.Caption := ' ';
      A05.Caption := ' ';   B05.Caption := ' ';
      A06.Caption := ' ';   B06.Caption := ' ';
      A07.Caption := ' ';   B07.Caption := ' ';
      A08.Caption := ' ';   B08.Caption := ' ';
      A09.Caption := ' ';   B09.Caption := ' ';
      A10.Caption := ' ';   B10.Caption := ' ';
      A11.Caption := ' ';   B11.Caption := ' ';
      A12.Caption := ' ';   B12.Caption := ' ';
      A13.Caption := ' ';   B13.Caption := ' ';
      A14.Caption := ' ';   B14.Caption := ' ';
      A15.Caption := ' ';   B15.Caption := ' ';
      A16.Caption := ' ';   B16.Caption := ' ';
      A17.Caption := ' ';   B17.Caption := ' ';
      A18.Caption := ' ';   B18.Caption := ' ';
      A19.Caption := ' ';   B19.Caption := ' ';
      A20.Caption := ' ';   B20.Caption := ' ';
      A21.Caption := ' ';   B21.Caption := ' ';
      A22.Caption := ' ';   B22.Caption := ' ';
      A23.Caption := ' ';   B23.Caption := ' ';
      A24.Caption := ' ';   B24.Caption := ' ';
      A25.Caption := ' ';   B25.Caption := ' ';
      A26.Caption := ' ';   B26.Caption := ' ';
      A27.Caption := ' ';   B27.Caption := ' ';
      A28.Caption := ' ';   B28.Caption := ' ';
      A29.Caption := ' ';   B29.Caption := ' ';
      A30.Caption := ' ';   B30.Caption := ' ';
      A31.Caption := ' ';   B31.Caption := ' ';
      A32.Caption := ' ';   B32.Caption := ' ';
      A33.Caption := ' ';   B33.Caption := ' ';
      A34.Caption := ' ';   B34.Caption := ' ';
      A35.Caption := ' ';   B35.Caption := ' ';
      A36.Caption := ' ';   B36.Caption := ' ';
      A37.Caption := ' ';   B37.Caption := ' ';
      A38.Caption := ' ';   B38.Caption := ' ';
      A39.Caption := ' ';   B39.Caption := ' ';
      A40.Caption := ' ';   B40.Caption := ' ';
      A41.Caption := ' ';   B41.Caption := ' ';
      A42.Caption := ' ';   B42.Caption := ' ';
      A43.Caption := ' ';   B43.Caption := ' ';
      A44.Caption := ' ';   B44.Caption := ' ';
      A45.Caption := ' ';   B45.Caption := ' ';
      A46.Caption := ' ';   B46.Caption := ' ';
      A47.Caption := ' ';   B47.Caption := ' ';
      A48.Caption := ' ';   B48.Caption := ' ';
      A49.Caption := ' ';   B49.Caption := ' ';
      A50.Caption := ' ';   B50.Caption := ' ';
      A51.Caption := ' ';   B51.Caption := ' ';
      A52.Caption := ' ';   B52.Caption := ' ';
      A53.Caption := ' ';   B53.Caption := ' ';
      A54.Caption := ' ';   B54.Caption := ' ';
      A55.Caption := ' ';   B55.Caption := ' ';
      A56.Caption := ' ';   B56.Caption := ' ';
      A57.Caption := ' ';   B57.Caption := ' ';
      A58.Caption := ' ';   B58.Caption := ' ';
      A59.Caption := ' ';   B59.Caption := ' ';
      A60.Caption := ' ';   B60.Caption := ' ';
     end
  else
  Begin
  A01.Caption := Dia_Dezena();   B01.Caption := Dia_Unidade();
  A02.Caption := Dia_Dezena();   B02.Caption := Dia_Unidade();
  A03.Caption := Dia_Dezena();   B03.Caption := Dia_Unidade();
  A04.Caption := Dia_Dezena();   B04.Caption := Dia_Unidade();
  A05.Caption := Dia_Dezena();   B05.Caption := Dia_Unidade();
  A06.Caption := Dia_Dezena();   B06.Caption := Dia_Unidade();
  A07.Caption := Dia_Dezena();   B07.Caption := Dia_Unidade();
  A08.Caption := Dia_Dezena();   B08.Caption := Dia_Unidade();
  A09.Caption := Dia_Dezena();   B09.Caption := Dia_Unidade();
  A10.Caption := Dia_Dezena();   B10.Caption := Dia_Unidade();
  A11.Caption := Dia_Dezena();   B11.Caption := Dia_Unidade();
  A12.Caption := Dia_Dezena();   B12.Caption := Dia_Unidade();
  A13.Caption := Dia_Dezena();   B13.Caption := Dia_Unidade();
  A14.Caption := Dia_Dezena();   B14.Caption := Dia_Unidade();
  A15.Caption := Dia_Dezena();   B15.Caption := Dia_Unidade();
  A16.Caption := Dia_Dezena();   B16.Caption := Dia_Unidade();
  A17.Caption := Dia_Dezena();   B17.Caption := Dia_Unidade();
  A18.Caption := Dia_Dezena();   B18.Caption := Dia_Unidade();
  A19.Caption := Dia_Dezena();   B19.Caption := Dia_Unidade();
  A20.Caption := Dia_Dezena();   B20.Caption := Dia_Unidade();
  A21.Caption := Dia_Dezena();   B21.Caption := Dia_Unidade();
  A22.Caption := Dia_Dezena();   B22.Caption := Dia_Unidade();
  A23.Caption := Dia_Dezena();   B23.Caption := Dia_Unidade();
  A24.Caption := Dia_Dezena();   B24.Caption := Dia_Unidade();
  A25.Caption := Dia_Dezena();   B25.Caption := Dia_Unidade();
  A26.Caption := Dia_Dezena();   B26.Caption := Dia_Unidade();
  A27.Caption := Dia_Dezena();   B27.Caption := Dia_Unidade();
  A28.Caption := Dia_Dezena();   B28.Caption := Dia_Unidade();
  A29.Caption := Dia_Dezena();   B29.Caption := Dia_Unidade();
  A30.Caption := Dia_Dezena();   B30.Caption := Dia_Unidade();
  A31.Caption := Dia_Dezena();   B31.Caption := Dia_Unidade();
  A32.Caption := Dia_Dezena();   B32.Caption := Dia_Unidade();
  A33.Caption := Dia_Dezena();   B33.Caption := Dia_Unidade();
  A34.Caption := Dia_Dezena();   B34.Caption := Dia_Unidade();
  A35.Caption := Dia_Dezena();   B35.Caption := Dia_Unidade();
  A36.Caption := Dia_Dezena();   B36.Caption := Dia_Unidade();
  A37.Caption := Dia_Dezena();   B37.Caption := Dia_Unidade();
  A38.Caption := Dia_Dezena();   B38.Caption := Dia_Unidade();
  A39.Caption := Dia_Dezena();   B39.Caption := Dia_Unidade();
  A40.Caption := Dia_Dezena();   B40.Caption := Dia_Unidade();
  A41.Caption := Dia_Dezena();   B41.Caption := Dia_Unidade();
  A42.Caption := Dia_Dezena();   B42.Caption := Dia_Unidade();
  A43.Caption := Dia_Dezena();   B43.Caption := Dia_Unidade();
  A44.Caption := Dia_Dezena();   B44.Caption := Dia_Unidade();
  A45.Caption := Dia_Dezena();   B45.Caption := Dia_Unidade();
  A46.Caption := Dia_Dezena();   B46.Caption := Dia_Unidade();
  A47.Caption := Dia_Dezena();   B47.Caption := Dia_Unidade();
  A48.Caption := Dia_Dezena();   B48.Caption := Dia_Unidade();
  A49.Caption := Dia_Dezena();   B49.Caption := Dia_Unidade();
  A50.Caption := Dia_Dezena();   B50.Caption := Dia_Unidade();
  A51.Caption := Dia_Dezena();   B51.Caption := Dia_Unidade();
  A52.Caption := Dia_Dezena();   B52.Caption := Dia_Unidade();
  A53.Caption := Dia_Dezena();   B53.Caption := Dia_Unidade();
  A54.Caption := Dia_Dezena();   B54.Caption := Dia_Unidade();
  A55.Caption := Dia_Dezena();   B55.Caption := Dia_Unidade();
  A56.Caption := Dia_Dezena();   B56.Caption := Dia_Unidade();
  A57.Caption := Dia_Dezena();   B57.Caption := Dia_Unidade();
  A58.Caption := Dia_Dezena();   B58.Caption := Dia_Unidade();
  A59.Caption := Dia_Dezena();   B59.Caption := Dia_Unidade();
  A60.Caption := Dia_Dezena();   B60.Caption := Dia_Unidade();
End;
end;

procedure TDoc_DiarioQR.DetNotaBeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
var statusX  : string;
begin
  if DetNota.Color = clWhite then DetNota.Color := DM.ParametrosCOR_ZEBRADO.Value
   else DetNota.Color := clWhite;
  m_det_faltas := DM.DiarioDET_FALTAS.Value;


  if (DM.DiarioALU_DATA_SAIDA.Value < DM.BimestresFIM.Value) and
     (not DM.DiarioALU_DATA_SAIDA.IsNull) then begin
    if DM.DiarioALU_STATUS.Value = 'T'  then
    begin
      if DM.DiarioALU_SEXO.Value = 'M' then
        statusX := 'TRANSFERIDO' else statusX := 'TRANSFERIDA';
    end;

    if DM.DiarioALU_STATUS.Value = 'R'  then
    begin
      if DM.DiarioALU_SEXO.Value = 'M' then
        statusX := 'RECLASSIFICADO' else statusX := 'RECLASSIFICADA';
    end;

    if DM.DiarioALU_STATUS.Value = 'D' then
       statusX := 'DESISTENTE';

   if ((DM.DiarioMODALIDADE.Value = 'DME') and (dm.DisciplinasCODIGO.Value = 10)) Then
            statusX := 'DISPENSADO';

    m_det_faltas := m_det_faltas + DM.DiarioALU_DATA_SAIDA.AsString+'-'+statusX+
      StringOfChar('X',67);
  end;
  Begin
    F01.Caption := Det_Falta_X(01);
    F02.Caption := Det_Falta_X(02);
    F03.Caption := Det_Falta_X(03);
    F04.Caption := Det_Falta_X(04);
    F05.Caption := Det_Falta_X(05);
    F06.Caption := Det_Falta_X(06);
    F07.Caption := Det_Falta_X(07);
    F08.Caption := Det_Falta_X(08);
    F09.Caption := Det_Falta_X(09);
    F10.Caption := Det_Falta_X(10);
    F11.Caption := Det_Falta_X(11);
    F12.Caption := Det_Falta_X(12);
    F13.Caption := Det_Falta_X(13);
    F14.Caption := Det_Falta_X(14);
    F15.Caption := Det_Falta_X(15);
    F16.Caption := Det_Falta_X(16);
    F17.Caption := Det_Falta_X(17);
    F18.Caption := Det_Falta_X(18);
    F19.Caption := Det_Falta_X(19);
    F20.Caption := Det_Falta_X(20);
    F21.Caption := Det_Falta_X(21);
    F22.Caption := Det_Falta_X(22);
    F23.Caption := Det_Falta_X(23);
    F24.Caption := Det_Falta_X(24);
    F25.Caption := Det_Falta_X(25);
    F26.Caption := Det_Falta_X(26);
    F27.Caption := Det_Falta_X(27);
    F28.Caption := Det_Falta_X(28);
    F29.Caption := Det_Falta_X(29);
    F30.Caption := Det_Falta_X(30);
    F31.Caption := Det_Falta_X(31);
    F32.Caption := Det_Falta_X(32);
    F33.Caption := Det_Falta_X(33);
    F34.Caption := Det_Falta_X(34);
    F35.Caption := Det_Falta_X(35);
    F36.Caption := Det_Falta_X(36);
    F37.Caption := Det_Falta_X(37);
    F38.Caption := Det_Falta_X(38);
    F39.Caption := Det_Falta_X(39);
    F40.Caption := Det_Falta_X(40);
    F41.Caption := Det_Falta_X(41);
    F42.Caption := Det_Falta_X(42);
    F43.Caption := Det_Falta_X(43);
    F44.Caption := Det_Falta_X(44);
    F45.Caption := Det_Falta_X(45);
    F46.Caption := Det_Falta_X(46);
    F47.Caption := Det_Falta_X(47);
    F48.Caption := Det_Falta_X(48);
    F49.Caption := Det_Falta_X(49);
    F50.Caption := Det_Falta_X(50);
    F51.Caption := Det_Falta_X(51);
    F52.Caption := Det_Falta_X(52);
    F53.Caption := Det_Falta_X(53);
    F54.Caption := Det_Falta_X(54);
    F55.Caption := Det_Falta_X(55);
    F56.Caption := Det_Falta_X(56);
    F57.Caption := Det_Falta_X(57);
    F58.Caption := Det_Falta_X(58);
    F59.Caption := Det_Falta_X(59);
    F60.Caption := Det_Falta_X(60);
  End;
  if not DM.DiarioMEDIA.IsNull then Media.Caption := DM.DiarioMEDIA.DisplayText
    else Media.Caption := '----';
end;

procedure TDoc_DiarioQR.Tot_FaltasPrint(sender: TObject;
  var Value: String);
begin
  if Value = '0' then Value := '-';
  if Doc_Diario.Bimestre.ItemIndex = 4 then Value := '-';
  if dm.DiarioALU_STATUS.Value = 'R' then
     value := '-';

end;

procedure TDoc_DiarioQR.SummaryBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
begin
  if Doc_Diario.Bimestre.ItemIndex = 4 then begin
    AulasDd.Enabled := false;
    AulasDadas.Enabled := false;
    AulasPr.Enabled := false;
    AulasPrevistas.Enabled := false;
  end;
  DataExt.Data := DM.BimestresFIM.Value;
  AulasDadas.Caption := FormatFloat('00',aulasD);
  AulasPrevistas.Caption := FormatFloat('00',Doc_Diario.AulasPrev.Value);
  QRObs.Lines := Doc_Diario.ObsDiario.Lines;
end;

end.
